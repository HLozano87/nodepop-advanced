<%- include('header') %>
<main class="flex-grow">
  <div class="max-w-7xl mx-auto px-4 mt-6">
    <% if (!session.userId) { %>
  
      <div class="bg-blue-100 border border-blue-300 text-blue-800 px-4 py-3 rounded mb-6">
        <%= __("To view your products, you must") %>
        <a href="/login" class="underline font-semibold hover:text-blue-600">login</a>.
      </div>
    <% } else { %>
  
      <div class="flex items-center justify-between mb-6">
        <h2 class="text-2xl font-bold text-gray-800"><%= __("My Products") %></h2>
        <a href="/user/new" class="inline-block bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded">
          <%= __("Add new product") %>
        </a>
      </div>
  
      <% if (products.length === 0) { %>
  
        <div class="bg-yellow-100 border border-yellow-300 text-yellow-800 px-4 py-3 rounded mb-6">
          <%= __("You have no products, add your first product!") %>
        </div>
  
      <% } else { %>
  
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
          <% for (const product of products) { %>
            <div class="bg-white rounded shadow-md overflow-hidden flex flex-col" id="<%= product._id %>">
              <img
                src="<%= product.image ? `/uploads/${product.image}` : 'https://placehold.co/600x400.png' %>"
                alt="<%= product.name %>"
                class="w-full h-48 object-cover"
              />
              <div class="p-4 flex-1 flex flex-col justify-between">
                <div>
                  <h3 class="text-lg font-semibold text-gray-900"><%= product.name %></h3>
  
                  <% if (product.tags && product.tags.length > 0) { %>
                    <div class="mt-2">
                      <% for (const tag of product.tags) { %>
                        <span class="inline-block bg-gray-200 text-gray-800 text-xs font-medium mr-2 px-2 py-1 rounded">
                          <%= tag %>
                        </span>
                      <% } %>
                    </div>
                  <% } %>
                </div>
  
                <p class="text-blue-600 font-bold text-lg mt-4">
                  <%= product.price.toFixed(2) %>‚Ç¨
                </p>
              </div>
  
              <div class="px-4 py-3 bg-gray-50 border-t flex justify-between items-center">
                <form
                  action="/user/delete/<%= product._id %>"
                  method="post"
                  class="inline"
                >
                  <button
                    type="submit"
                    class="text-red-600 hover:text-red-800 text-sm font-medium flex items-center gap-1"
                    onclick="return confirm('<%= __(`¬øAre you sure you want to remove?`) %>')"
                  >
                    üóëÔ∏è <%= __("Delete") %>
                  </button>
                </form>
              </div>
            </div>
          <% } %>
        </div>
  
      <% } %>
    <% } %>
  </div>
</main>

<%- include('footer') %>